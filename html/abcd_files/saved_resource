(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var _Parser=require("./lib/Parser.js");var _Tracker=require("./lib/Tracker.js");window.mtrs=new _Tracker.Tracker(new _Parser.Parser,false)},{"./lib/Parser.js":2,"./lib/Tracker.js":3}],2:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Parser=exports.Parser=function(){function Parser(){_classCallCheck(this,Parser)}_createClass(Parser,[{key:"hasDocument",value:function hasDocument(){return typeof document!=="undefined"}},{key:"id",get:function get(){var obj=document.querySelector("#mtrs");return obj?obj.getAttribute("data-id").replace(/^\s+|\s+$/gm,""):"unknown"}},{key:"title",get:function get(){return document.title}},{key:"host",get:function get(){return document.location.host}},{key:"url",get:function get(){return document.location.href}},{key:"agent",get:function get(){return navigator.userAgent}},{key:"referer",get:function get(){var ref="";try{ref=top.document.referrer}catch(x){try{ref=parent.document.referrer}catch(y){}}if(ref===""){ref=document.referrer}return ref}},{key:"ctime",get:function get(){return parseInt((new Date).getTime(),10)}},{key:"screen",get:function get(){try{return screen.width}catch(e){return 0}}},{key:"window",get:function get(){var w=0,h=0;try{if(typeof window.innerWidth==="number"){w=window.innerWidth;h=window.innerHeight}else if(document.documentElement&&document.documentElement.clientWidth){w=document.documentElement.clientWidth;h=document.documentElement.clientHeight}else if(document.body&&document.body.clientWidth){w=document.body.clientWidth;h=document.body.clientHeight}}catch(e){}return w+"x"+h}}]);return Parser}()},{}],3:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BASE_URL="https://track.mtrs.io";var Tracker=exports.Tracker=function(){function Tracker(parser,dry){_classCallCheck(this,Tracker);this.version="0.0.1";this.parser=parser;if(!parser.hasDocument()){throw"Not running in a browser. Sorry â€¦"}if(!dry){this.load(this.url)}}_createClass(Tracker,[{key:"load",value:function load(url){var img=new Image;img.src=url}},{key:"enc",value:function enc(s){return encodeURIComponent(s)}},{key:"add",value:function add(name,data,meta){var keys=Object.keys(meta||{});var opts=[];for(var i=0,m=keys.length;i<m;i++){var key=keys[i];opts.push(key+":"+meta[key])}this.load(BASE_URL+"/event?"+["site="+this.parser.id,"time="+this.parser.ctime,"name="+this.enc(name),"data="+this.enc(data),"meta="+this.enc(opts.join(","))].join("&"))}},{key:"keys",get:function get(){return["id","ctime","host","url","title","referer","agent","screen","window"]}},{key:"url",get:function get(){var _this=this;return BASE_URL+"?"+this.keys.reduce(function(a,k){a.push(k+"="+_this.enc(_this.parser[k]));return a},[]).join("&")}},{key:"data",get:function get(){var _this2=this;return this.keys.reduce(function(a,k){a[k]=_this2.parser[k];return a},[])}}]);return Tracker}()},{}]},{},[1]);
